<!doctype html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Announcements</title><link rel='stylesheet' href='css/style.css'></head><body><div class='header'><div style='display:flex;align-items:center;gap:12px'><img src='assets/aspira-logo.png' class='logo-small'><div>ASPIRA</div></div><div><button id='logout' class='btn'>Logout</button></div></div><div class='container'><h1>Announcements</h1><div id='annList'></div><div style='margin-top:12px' class='card'><h3>Post Announcement</h3><div><input id='atitle' class='input' placeholder='Title'><textarea id='amsg' class='input' placeholder='Message'></textarea><button id='post' class='btn'>Post</button></div></div></div><script>const API='/api'; const token=localStorage.getItem('aspira_token'); if(!token) location.href='login.html'; async function api(path,opt={}){opt.headers={...(opt.headers||{}),'Authorization':'Bearer '+token, ...(opt.headers||{})}; return fetch(API+path,opt);} document.getElementById('logout').addEventListener('click',()=>{localStorage.removeItem('aspira_token'); location.href='login.html'});
async function load(){ const anns = await (await api('/announcements')).json(); document.getElementById('annList').innerHTML = anns.map(a=>`<div class='card' style='margin-bottom:8px;padding:10px'><strong>${a.title}</strong><div class='small'>${a.message}</div><div class='small'>By ${(a.author && (a.author.firstname + ' ' + a.author.lastname)) || ''}</div></div>`).join(''); }
load(); document.getElementById('post').addEventListener('click', async ()=>{ const title=document.getElementById('atitle').value; const message=document.getElementById('amsg').value; const res = await api('/announcements',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({title,message})}); if(res.ok){ alert('Posted'); document.getElementById('atitle').value=''; document.getElementById('amsg').value=''; load(); } else alert('Failed'); });</script></body></html>